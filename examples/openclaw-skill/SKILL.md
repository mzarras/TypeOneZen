---
name: typeonezen
description: Query and log Type 1 Diabetes data from the TypeOneZen system
triggers:
  - BG
  - blood glucose
  - blood sugar
  - CGM
  - insulin
  - bolus
  - basal
  - carbs
  - meal
  - workout
  - exercise
  - time in range
  - TIR
  - A1C
  - health summary
  - monitor status
  - Dexcom
  - glucose
---

# TypeOneZen Skill

Query and log Type 1 Diabetes data. All data lives in a SQLite database at `~/TypeOneZen/data/TypeOneZen.db`. Timestamps are stored as ISO8601 UTC; display in `America/New_York`.

## Quick Start — Use Scripts First

For common queries, run the pre-built scripts. They return compact JSON (fewer tokens than raw SQL).

### Read Queries (`tz_query.py`)

```bash
# Current BG + trend + minutes since last reading
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py now

# BG stats over last N hours (avg, min, max, TIR, count)
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py range 24

# Insulin doses over last N hours (by type, totals)
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py insulin 24

# Recent meals with macros
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py meals 24

# Recent workouts with BG correlation
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py workouts 7

# Latest health summary (reads cached stats, no recomputation)
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py summary

# Run BG monitor rules (dry-run, no alerts sent)
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_query.py monitor
```

### Write Operations (`tz_log.py`)

```bash
# Log a meal
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_log.py meal --desc "oatmeal with banana" --carbs 45 --protein 8 --fiber 5

# Log a note
python3 ~/.openclaw/workspace/skills/typeonezen/scripts/tz_log.py note --body "Felt shaky before lunch" --tags "hypo,symptom"
```

## When Scripts Don't Cover It

For custom queries beyond what the scripts provide, write SQL directly against the database. See `references/schema.md` for table definitions and query patterns.

```bash
sqlite3 ~/TypeOneZen/data/TypeOneZen.db "SELECT ..."
```

## Operational Context

- **BG monitoring is live**: `monitor.py` runs every 5 min via cron. It checks post-meal spikes, sustained highs, rapid drops, and overnight highs. Alerts go via iMessage. No need to duplicate this logic.
- **Pre-workout rule is disabled** in the auto-monitor. Only mention workout BG risk if the user explicitly says they're about to exercise.
- **Fake-carb correction pattern**: Some users log a "fake carb" bolus to correct highs without actual food (to bypass conservative pump IOB limits). If you see a bolus with a note like "correction" or zero-carb context, that's what's happening.
- **TIR goal**: 90%+ time in range (70–180 mg/dL).
- **Dexcom poller**: Runs every 5 min via cron (`poller.py`). Readings may lag up to 5 min.
- **Health summaries**: Generated by `generate_summary.py` → `~/TypeOneZen/summaries/stats_cache.json` and `health_context.md`. Use `tz_query.py summary` to read cached stats rather than regenerating.

## Response Style

- Lead with the number (e.g., "104 mg/dL, flat"). Don't bury the answer.
- Use mg/dL, not mmol/L.
- Times in Eastern (America/New_York).
- Keep it conversational — not a medical dashboard.
